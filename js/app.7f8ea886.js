(function(e){function t(t){for(var a,i,l=t[0],c=t[1],s=t[2],d=0,v=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&v.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(v.length)v.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,l=1;l<n.length;l++){var c=n[l];0!==r[c]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={app:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/gamemap/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var s=0;s<l.length;s++)t(l[s]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"18c7":function(e,t,n){},"24b9":function(e,t,n){"use strict";var a=n("18c7"),r=n.n(a);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",[n("v-app-bar",{attrs:{fixed:"",app:""}},[n("v-toolbar-title",{staticClass:"headline text-uppercase"},[n("span",[e._v("Game Map")])]),n("v-btn",{staticClass:"ml-4",attrs:{text:"",rounded:""},on:{click:e.copyID}},[e._v("Copy ID")]),n("v-btn",{staticClass:"ml-2",attrs:{text:"",rounded:""},on:{click:e.exit}},[e._v("Exit")]),n("v-spacer"),e.installPrompt?n("v-btn",{attrs:{text:"",rounded:""},on:{click:e.installPWA}},[n("v-icon",[e._v("mdi-download")]),e._v("Install ")],1):e._e(),n("v-btn",{attrs:{text:"",rounded:"",href:"https://github.com/henkelmax/gamemap",target:"_blank"}},[n("v-icon",[e._v("mdi-open-in-new")]),e._v("GitHub ")],1)],1),n("Map",{ref:"map"}),n("v-snackbar",{scopedSlots:e._u([{key:"action",fn:function(t){var a=t.attrs;return[n("v-btn",e._b({attrs:{color:"pink",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",a,!1),[e._v(" Close ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.text)+" ")])],1)],1)},o=[],i=(n("d81d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"map-area"}},[e.visible?n("l-map",{ref:"map",attrs:{id:"map","min-zoom":e.minZoom,"max-zoom":e.maxZoom,zoom:e.zoom,center:e.center,crs:e.crs},on:{click:function(t){return e.onClick(t.latlng)},contextmenu:e.onRightClick}},[n("l-image-overlay",{attrs:{url:e.url,bounds:e.bounds}}),e._l(Object.entries(e.userLines),(function(t){var a=t[0],r=t[1];return[r.length>1?n("l-polyline",{key:"line-"+a,attrs:{"lat-lngs":r,color:e.drawColors[a]?e.drawColors[a]:"#FF0000"}}):1===r.length?n("l-circle-marker",{key:"circle-"+a,attrs:{"lat-lng":{lat:r[0][0],lng:r[0][1]},radius:2,color:e.drawColors[a]?e.drawColors[a]:"#FF0000"}}):e._e()]})),e._l(e.markers,(function(t,a){return n("l-marker",{key:a,attrs:{"lat-lng":{lat:t.lat,lng:t.lng}}},[n("l-popup",[n("div",{staticClass:"text-center"},[n("b",[e._v(e._s(t.name))]),n("br"),n("v-btn",{attrs:{depressed:"",color:"error"},on:{click:function(n){return e.deleteMarker(t.id)}}},[e._v(" Delete ")])],1)])],1)}))],2):e._e(),e.visible?n("div",{staticClass:"toolbox"},[n("v-btn",{staticClass:"mt-2 mr-2",on:{click:function(t){e.drawMode=!e.drawMode}}},[e._v(" "+e._s(e.drawMode?"Disable draw mode":"Enable draw mode")+" ")]),e.drawMode?n("v-btn",{staticClass:"delete mt-2 mr-2",on:{click:e.color}},[e._v(" Color ")]):e._e(),e.drawMode?n("v-btn",{staticClass:"delete mt-2 mr-2",on:{click:e.deleteLine}},[e._v(" Delete ")]):e._e()],1):e._e(),n("StartDialog",{ref:"startDialog"}),n("CreateDialog",{ref:"createDialog"}),n("IDDialog",{ref:"idDialog"}),n("JoinDialog",{ref:"joinDialog"}),n("ColorDialog",{ref:"colorDialog"}),n("v-overlay",{attrs:{value:e.overlay}},[n("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)],1)}),l=[],c=(n("99af"),n("4de4"),n("b0c0"),n("4fad"),n("b64b"),n("d3b7"),n("07ac"),n("2909")),s=n("3835"),u=n("b85c"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"500"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Welcome")]),n("v-card-text",[e._v(" Do you want to join a room or create a room? ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:e.join}},[e._v("Join")]),n("v-btn",{attrs:{text:""},on:{click:e.create}},[e._v("Create")])],1)],1)],1)],1)},v=[],f={data:function(){return{active:!1,resolve:null}},methods:{open:function(){var e=this;return this.active=!0,new Promise((function(t,n){e.resolve=t}))},join:function(){this.active=!1,this.resolve(!1)},create:function(){this.active=!1,this.resolve(!0)}}},m=f,p=n("2877"),h=n("6544"),b=n.n(h),g=n("8336"),k=n("b0af"),w=n("99d9"),x=n("a523"),C=n("169a"),_=n("2fa4"),y=Object(p["a"])(m,d,v,!1,null,null,null),V=y.exports;b()(y,{VBtn:g["a"],VCard:k["a"],VCardActions:w["a"],VCardText:w["b"],VCardTitle:w["c"],VContainer:x["a"],VDialog:C["a"],VSpacer:_["a"]});var D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"500"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Create a new room")]),n("v-card-text",[n("v-form",{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-text-field",{attrs:{rules:e.nameRules,counter:32,label:"Your Name",required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("v-file-input",{attrs:{label:"Select Map",rules:e.fileRules,accept:"image/*",required:""},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:e.back}},[e._v("Back")]),n("v-btn",{attrs:{text:"",disabled:!e.valid||!e.file},on:{click:e.cont}},[e._v("Continue")])],1)],1)],1)],1)},O=[],j=n("b66e"),P={data:function(){return{valid:!1,name:"",nameRules:[function(e){return!!e||"Name is required"},function(e){return e.length>=3||"Name must be at least 3 characters"},function(e){return e.length<=32||"Name must be 32 characters or less"},function(e){return/^[a-zA-Z ]{3,32}$/.test(e)||"Name must be only letters and spaces"}],file:null,fileRules:[function(e){return!e||e.size<1e7||"Map size should be less than 10 MB"}],active:!1,resolve:null}},created:function(){this.name=Object(j["c"])({dictionaries:[j["b"],j["a"]],style:"capital",separator:" "})},methods:{open:function(e){var t=this;return this.id=e,this.active=!0,new Promise((function(e,n){t.resolve=e}))},cont:function(){this.active=!1,this.resolve({name:this.name,file:this.file})},back:function(){window.location.reload()}}},$=P,I=n("23a7"),M=n("4bd4"),S=n("8654"),N=Object(p["a"])($,D,O,!1,null,null,null),L=N.exports;b()(N,{VBtn:g["a"],VCard:k["a"],VCardActions:w["a"],VCardText:w["b"],VCardTitle:w["c"],VContainer:x["a"],VDialog:C["a"],VFileInput:I["a"],VForm:M["a"],VSpacer:_["a"],VTextField:S["a"]});var T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-dialog",{attrs:{scrollable:"","max-width":"500"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Your ID")]),n("v-card-text",[e._v(" Your ID is "),n("b",{attrs:{id:"id"}},[e._v(e._s(e.id))])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:e.close}},[e._v("Close")])],1)],1)],1)],1)},R=[],A={data:function(){return{id:"",active:!1}},methods:{open:function(e){this.id=e,this.active=!0},close:function(){this.active=!1}}},F=A,B=Object(p["a"])(F,T,R,!1,null,null,null),E=B.exports;b()(B,{VBtn:g["a"],VCard:k["a"],VCardActions:w["a"],VCardText:w["b"],VCardTitle:w["c"],VContainer:x["a"],VDialog:C["a"],VSpacer:_["a"]});var z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"500"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Join a room")]),n("v-card-text",[n("v-form",{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-text-field",{attrs:{rules:e.nameRules,counter:32,label:"Your Name",required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("v-text-field",{attrs:{rules:e.idRules,label:"Room ID",required:""},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:e.back}},[e._v("Back")]),n("v-btn",{attrs:{text:"",disabled:!e.valid},on:{click:e.join}},[e._v("Join")])],1)],1)],1)],1)},J=[],q={data:function(){return{active:!1,resolve:null,valid:!1,name:"",nameRules:[function(e){return!!e||"Name is required"},function(e){return e.length>=3||"Name must be at least 3 characters"},function(e){return e.length<=32||"Name must be 32 characters or less"},function(e){return/^[a-zA-Z ]{3,32}$/.test(e)||"Name must be only letters and spaces"}],id:"",idRules:[function(e){return!!e||"ID is required"},function(e){return 16===e.length||"ID must be 16 characters"},function(e){return/^[a-z0-9]{16}$/.test(e)||"Name must be only lowercase letters and numbers"}]}},created:function(){this.name=Object(j["c"])({dictionaries:[j["b"],j["a"]],style:"capital",separator:" "})},methods:{open:function(){var e=this;return this.active=!0,new Promise((function(t,n){e.resolve=t}))},join:function(){this.active=!1,this.resolve({name:this.name,id:this.id})},back:function(){window.location.reload()}}},U=q,Z=Object(p["a"])(U,z,J,!1,null,null,null),W=Z.exports;b()(Z,{VBtn:g["a"],VCard:k["a"],VCardActions:w["a"],VCardText:w["b"],VCardTitle:w["c"],VContainer:x["a"],VDialog:C["a"],VForm:M["a"],VSpacer:_["a"],VTextField:S["a"]});var Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"500"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Choose your color")]),n("v-card-text",[n("v-row",{attrs:{justify:"space-around",align:"center"}},[n("v-color-picker",{attrs:{flat:""},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:e.ok}},[e._v("OK")])],1)],1)],1)],1)},G=[],H={data:function(){return{active:!1,resolve:null,color:"#FF0000"}},methods:{open:function(e){var t=this;return this.color=e,this.active=!0,new Promise((function(e,n){t.resolve=e}))},ok:function(){this.active=!1,this.resolve(this.color)}}},K=H,Q=n("03a4"),X=n("0fd9"),ee=Object(p["a"])(K,Y,G,!1,null,null,null),te=ee.exports;b()(ee,{VBtn:g["a"],VCard:k["a"],VCardActions:w["a"],VCardText:w["b"],VCardTitle:w["c"],VColorPicker:Q["a"],VContainer:x["a"],VDialog:C["a"],VRow:X["a"],VSpacer:_["a"]});var ne,ae=n("e11e"),re=n("a0bc"),oe=n.n(re),ie=n("ec26"),le={name:"Map",components:{StartDialog:V,CreateDialog:L,IDDialog:E,JoinDialog:W,ColorDialog:te},data:function(){return{overlay:!0,visible:!1,ownName:"",url:"",bounds:[[0,0],[1,1]],minZoom:-3,maxZoom:2,zoom:0,center:Object(ae["latLng"])(0,0),drawMode:!1,drawColors:{},userLines:[],markers:[],crs:ae["CRS"].Simple,master:!1,id:"",remoteID:""}},mounted:function(){var e=this;ne=new oe.a,ne.on("open",(function(){e.id=ne.id,ne.on("connection",(function(t){t.on("open",(function(){t.on("data",(function(n){e.onData(t,n)})),e.onConnectionOpened(t)}))})),e.overlay=!1,e.$refs.startDialog.open().then((function(t){t?e.$refs.createDialog.open().then((function(t){e.$refs.idDialog.open(ne.id),e.onCreated(t)})):e.$refs.joinDialog.open().then((function(t){e.onJoined(t)}))}))}))},methods:{onCreated:function(e){var t=this;this.ownName=e.name,this.master=!0,this.toBase64(e.file).then((function(e){t.url=e,t.visible=!0})).catch((function(e){console.error(e)}))},onJoined:function(e){var t=this;this.ownName=e.name,console.log("Joining to '".concat(e.id,"'"));var n=ne.connect(e.id,{label:e.name});n.on("open",(function(){t.remoteID=e.id,n.on("data",(function(e){t.onData(n,e)})),n.on("close",(function(){window.location.reload()}))}))},onData:function(e,t){if(console.log("Received data from '".concat(e?e.label:"self","': "),t),"image"===t.type)this.url=t.image,this.visible=!0;else if("marker"===t.type)this.markers.push(t.marker);else if("delete_marker"===t.type)this.markers=this.markers.filter((function(e){return e.id!==t.id}));else if("line"===t.type)this.$delete(this.userLines,t.id),this.$set(this.userLines,t.id,t.lines);else if("color"===t.type)this.$delete(this.drawColors,t.id),this.$set(this.drawColors,t.id,t.color);else if("broadcast"===t.type&&this.master){this.onData(e,t.data);for(var n=0,a=Object.values(ne.connections);n<a.length;n++){var r=a[n];r[0].send(t.data)}}},onConnectionOpened:function(e){console.log("Incoming connection from '".concat(e.label,"', '").concat(e.peer,"'")),e.send({type:"image",image:this.url});var t,n=Object(u["a"])(this.markers);try{for(n.s();!(t=n.n()).done;){var a=t.value;e.send({type:"marker",marker:a})}}catch(h){n.e(h)}finally{n.f()}for(var r=0,o=Object.entries(this.userLines);r<o.length;r++){var i=Object(s["a"])(o[r],2),l=i[0],c=i[1];e.send({type:"line",lines:c,id:l})}for(var d=0,v=Object.entries(this.drawColors);d<v.length;d++){var f=Object(s["a"])(v[d],2),m=f[0],p=f[1];e.send({type:"color",color:p,id:m})}},onClick:function(e){},onRightClick:function(e){var t=this;if(this.drawMode)return this.userLines[ne.id]||(this.userLines[ne.id]=[]),this.broadcastPacket({type:"line",id:ne.id,lines:[].concat(Object(c["a"])(this.userLines[ne.id]),[[e.latlng.lat,e.latlng.lng]])}),void this.$nextTick((function(){t.$forceUpdate()}));var n={lat:e.latlng.lat,lng:e.latlng.lng,name:this.ownName,id:Object(ie["a"])()};this.broadcastPacket({type:"marker",marker:n})},toBase64:function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)},a.readAsDataURL(e)}))},getSize:function(e){return new Promise((function(t,n){var a=new Image;a.addEventListener("load",(function(){t({width:a.naturalWidth,height:a.naturalHeight})})),a.src=e}))},broadcastPacket:function(e){var t={type:"broadcast",data:e};if(this.master)this.onData(null,t);else{var n,a=Object(u["a"])(ne.connections[Object.keys(ne.connections)[0]]);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.send(t)}}catch(o){a.e(o)}finally{a.f()}}},deleteMarker:function(e){this.broadcastPacket({type:"delete_marker",id:e})},color:function(){var e=this;this.$refs.colorDialog.open(this.drawColors).then((function(t){e.broadcastPacket({type:"color",id:e.id,color:t.hex})}))},deleteLine:function(){this.userLines[ne.id]&&(this.userLines[ne.id].pop(),this.broadcastPacket({type:"line",id:ne.id,lines:this.userLines[ne.id]}))}},watch:{url:function(e){var t=this;this.getSize(e).then((function(e){t.bounds=[[0,0],[e.height,e.width]],t.center=Object(ae["latLng"])(e.height/2,e.width/2)}))}},computed:{masterID:function(){return this.master?this.id:this.remoteID}}},ce=le,se=(n("24b9"),n("a797")),ue=n("490a"),de=Object(p["a"])(ce,i,l,!1,null,"182968e4",null),ve=de.exports;b()(de,{VBtn:g["a"],VOverlay:se["a"],VProgressCircular:ue["a"]});var fe={name:"App",components:{Map:ve},data:function(){return{installPrompt:null,snackbar:!1,text:""}},beforeCreate:function(){var e=this;window.addEventListener("beforeinstallprompt",(function(t){t.preventDefault(),e.installPrompt=t}))},methods:{copyID:function(){this.$clipboard(this.$refs.map.masterID),this.text="Copied to clipboard",this.snackbar=!0},installPWA:function(){var e=this;this.installPrompt&&(this.installPrompt.prompt(),this.installPrompt.userChoice.then((function(t){"accepted"===t.outcome&&(e.installPrompt=null)})))},exit:function(){window.location.reload()}}},me=fe,pe=n("7496"),he=n("40dc"),be=n("132d"),ge=n("f6c4"),ke=n("2db4"),we=n("2a7f"),xe=Object(p["a"])(me,r,o,!1,null,null,null),Ce=xe.exports;b()(xe,{VApp:pe["a"],VAppBar:he["a"],VBtn:g["a"],VIcon:be["a"],VMain:ge["a"],VSnackbar:ke["a"],VSpacer:_["a"],VToolbarTitle:we["a"]});var _e=n("9483");Object(_e["a"])("".concat("/gamemap/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("6cc5");var ye=n("2699"),Ve=n("e464"),De=n("4e2b"),Oe=n("f60f"),je=n("635f"),Pe=n("ea97"),$e=n("f309");a["a"].use($e["a"]);var Ie=new $e["a"]({}),Me=(n("d5e8"),n("5363"),n("4ae6")),Se=n.n(Me);a["a"].config.productionTip=!1,delete ae["Icon"].Default.prototype._getIconUrl,ae["Icon"].Default.mergeOptions({iconRetinaUrl:n("584d"),iconUrl:n("6397"),shadowUrl:n("e2b9")}),a["a"].use(Se.a),a["a"].component("l-map",ye["a"]),a["a"].component("l-image-overlay",Ve["a"]),a["a"].component("l-marker",De["a"]),a["a"].component("l-popup",Oe["a"]),a["a"].component("l-polyline",je["a"]),a["a"].component("l-circle-marker",Pe["a"]),new a["a"]({vuetify:Ie,render:function(e){return e(Ce)}}).$mount("#app")},"5e11":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="5e11"}});